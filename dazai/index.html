<!DOCTYPE html>
<html lang="lt">
<head>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-1VLD2QNVLR"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-1VLD2QNVLR');
    </script>
    
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Miltelinio da≈æymo da≈æ≈≥ katalogas - turimi da≈æai sandƒólyje realiu laiku. RAL spalvos, gamintojai Ripol, Eko Color, Axalta, Interpon. Patikrinkite prieinamumo ir kiekius. Greitas u≈æsakymas +370 625 02563.">
    <meta name="keywords" content="miltelinio da≈æymo da≈æai, ral spalvos, ripol da≈æai, eko color da≈æai, axalta da≈æai, interpon da≈æai, miltelinio da≈æymo spalvos, da≈æ≈≥ katalogas, da≈æ≈≥ sandƒólis, turimi da≈æai">
    <title>Miltelinio Da≈æymo Da≈æ≈≥ Katalogas | Turimi RAL Spalvos - UAB Miltegona</title>
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://miltegona.lt/dazai/">
    <meta property="og:title" content="Miltelinio Da≈æymo Da≈æ≈≥ Katalogas | UAB Miltegona">
    <meta property="og:description" content="Miltelinio da≈æymo da≈æ≈≥ katalogas - turimi da≈æai sandƒólyje. RAL spalvos, gamintojai Ripol, Eko Color, Axalta. Realaus laiko prieinamumas.">
    <meta property="og:image" content="https://miltegona.lt/assets/candy-purple-bike-parts-close-up_orig-d95WOabxNns7N0Ja.jpg">
    
    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://miltegona.lt/dazai/">
    <meta property="twitter:title" content="Miltelinio Da≈æymo Da≈æ≈≥ Katalogas | UAB Miltegona">
    <meta property="twitter:description" content="Miltelinio da≈æymo da≈æ≈≥ katalogas - turimi da≈æai sandƒólyje. RAL spalvos realiu laiku.">
    <meta property="twitter:image" content="https://miltegona.lt/assets/candy-purple-bike-parts-close-up_orig-d95WOabxNns7N0Ja.jpg">
    
    <link rel="canonical" href="https://miltegona.lt/dazai/">
    <link rel="stylesheet" href="../css/style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            background-color: #000000;
            color: #e5e7eb;
        }
        
        .paints-section {
            padding: 80px 0;
            background: #0f1115;
        }
        
        .filters {
            background: #1a1d23;
            padding: 24px;
            border-radius: 8px;
            margin-bottom: 32px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.4);
            border: 1px solid #2d3238;
        }
        
        .filters-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 16px;
        }
        
        .filter-group {
            display: flex;
            flex-direction: column;
        }
        
        .filter-group label {
            font-weight: 600;
            margin-bottom: 8px;
            color: #e5e7eb;
            font-size: 14px;
        }
        
        .filter-group input,
        .filter-group select {
            padding: 12px;
            border: 2px solid #2d3238;
            border-radius: 6px;
            font-size: 15px;
            font-weight: 500;
            color: #e5e7eb;
            background: #0f1115;
            transition: border-color 0.3s;
        }
        
        .filter-group input:focus,
        .filter-group select:focus {
            outline: none;
            border-color: #FC9D17;
        }
        
        .paints-stats {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 24px;
            padding: 20px;
            background: #1a1d23;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.4);
            border: 1px solid #2d3238;
        }
        
        .paints-count {
            font-size: 18px;
            font-weight: 600;
            color: #e5e7eb;
        }
        
        .refresh-btn {
            padding: 12px 24px;
            background: #FC9D17;
            color: #000;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            font-size: 15px;
            transition: all 0.3s;
            box-shadow: 0 2px 4px rgba(252, 157, 23, 0.3);
        }
        
        .refresh-btn:hover {
            background: #d97706;
            box-shadow: 0 4px 8px rgba(252, 157, 23, 0.4);
            transform: translateY(-1px);
        }
        
        .paints-table-container {
            background: #1a1d23;
            border-radius: 8px;
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
            box-shadow: 0 4px 6px rgba(0,0,0,0.4);
            border: 1px solid #2d3238;
        }
        
        .paints-table {
            width: 100%;
            border-collapse: collapse;
            min-width: 1000px;
        }
        
        .paints-table thead {
            background: linear-gradient(135deg, #1a1d23 0%, #0f1115 100%);
            border-bottom: 2px solid #FC9D17;
        }
        
        .paints-table th {
            padding: 18px 16px;
            text-align: left;
            font-weight: 600;
            font-size: 15px;
            cursor: pointer;
            user-select: none;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            color: #FC9D17;
        }
        
        .paints-table th:hover {
            background: rgba(252, 157, 23, 0.1);
        }
        
        .paints-table td {
            padding: 16px;
            border-bottom: 1px solid #2d3238;
            font-size: 15px;
            font-weight: 500;
            color: #e5e7eb;
        }
        
        .paints-table tbody tr {
            transition: background 0.2s;
            background: #1a1d23;
        }
        
        .paints-table tbody tr:hover {
            background: #242830;
        }
        
        .paints-table tbody tr:nth-child(even) {
            background: #0f1115;
        }
        
        .paints-table tbody tr:nth-child(even):hover {
            background: #1a1d23;
        }
        
        .loading {
            text-align: center;
            padding: 60px;
            color: #9ca3af;
            font-size: 18px;
            font-weight: 500;
        }
        
        .error {
            text-align: center;
            padding: 40px;
            color: #f87171;
            background: rgba(239, 68, 68, 0.1);
            border-radius: 8px;
            margin: 20px 0;
            font-weight: 500;
            font-size: 16px;
            border: 1px solid rgba(239, 68, 68, 0.3);
        }
        
        .no-results {
            text-align: center;
            padding: 60px;
            color: #9ca3af;
            font-size: 18px;
            font-weight: 500;
        }
        
        .color-badge {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 6px 12px;
            background: linear-gradient(135deg, #FC9D17 0%, #d97706 100%);
            color: #000;
            border-radius: 6px;
            font-size: 14px;
            font-weight: 600;
            letter-spacing: 0.3px;
        }
        
        .color-preview {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 2px solid #fff;
            border-radius: 3px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.3);
            cursor: pointer;
            transition: transform 0.2s;
        }
        
        .color-preview:hover {
            transform: scale(1.2);
        }
        
        .color-popup {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.7);
            align-items: center;
            justify-content: center;
        }
        
        .color-popup-content {
            background: #1a1d23;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.5);
            text-align: center;
            border: 2px solid #2d3238;
            max-width: 400px;
        }
        
        .color-popup-swatch {
            width: 200px;
            height: 200px;
            margin: 0 auto 20px;
            border: 3px solid #fff;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.4);
        }
        
        .color-popup-code {
            font-size: 24px;
            font-weight: 700;
            color: #FC9D17;
            margin-bottom: 10px;
        }
        
        .color-popup-hex {
            font-size: 18px;
            color: #9ca3af;
            font-family: monospace;
            margin-bottom: 20px;
        }
        
        .color-popup-close {
            background: #FC9D17;
            color: #000;
            border: none;
            padding: 12px 30px;
            border-radius: 6px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .color-popup-close:hover {
            background: #d97706;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(252, 157, 23, 0.4);
        }
        
        .quantity {
            font-weight: 700;
            font-size: 16px;
            color: #3ba560;
        }
        
        @media (max-width: 768px) {
            .paints-table {
                font-size: 13px;
            }
            
            .paints-table th,
            .paints-table td {
                padding: 10px 8px;
            }
            
            .filters-grid {
                grid-template-columns: 1fr;
            }
            
            .color-badge {
                font-size: 12px;
                padding: 4px 8px;
            }

            .header-content h1 {
                font-size: 26px;
            }

            .color-popup-content {
                padding: 30px 20px;
            }

            .color-popup-swatch {
                width: 150px;
                height: 150px;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="container">
            <div class="header-content">
                <div class="logo">
                    <a href="/">
                        <img src="../assets/miltegona-logo-white-v4-Awv5M7Brq0SlKNEo.png" alt="UAB Miltegona" class="logo-img" style="height: 60px; width: auto;">
                    </a>
                </div>
                <button class="mobile-menu-toggle" aria-label="Menu">
                    <span></span>
                    <span></span>
                    <span></span>
                </button>
                <nav class="main-nav">
                    <ul>
                        <li><a href="/">Prad≈æia</a></li>
                        <li><a href="/apie-mus/">Apie mus</a></li>
                        <li><a href="/miltelinis-dazymas/">Paslaugos</a></li>
                        <li><a href="/dazai/" class="active">Turimi da≈æai</a></li>
                        <li><a href="/kaina/">Skaiƒçiuoklƒó</a></li>
                        <li><a href="/kontaktai/">Kontaktai</a></li>
                    </ul>
                </nav>
            </div>
        </div>
    </header>

    <!-- Page Header -->
    <section class="page-header" style="background: linear-gradient(135deg, #ff6b35 0%, #f7931e 100%); padding: 30px 0;">
        <div class="container">
            <h1 style="color: white; margin: 0; font-size: 36px;">Miltelinio Da≈æymo Da≈æ≈≥ Katalogas</h1>
            <p style="color: rgba(255,255,255,0.9); margin: 10px 0 0 0; font-size: 18px;">Realaus laiko informacija apie turim≈≥ da≈æ≈≥ atsargas</p>
        </div>
    </section>

    <!-- Paints Section -->
    <section class="paints-section">
        <div class="container">
            <!-- Filters -->
            <div class="filters">
                <div class="filters-grid">
                    <div class="filter-group">
                        <label for="searchInput">Paie≈°ka</label>
                        <input type="text" id="searchInput" placeholder="Ie≈°koti pagal gamintojƒÖ, spalvƒÖ, kodƒÖ...">
                    </div>
                    <div class="filter-group">
                        <label for="manufacturerFilter">Gamintojas</label>
                        <select id="manufacturerFilter">
                            <option value="">Visi gamintojai</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label for="surfaceFilter">Pavir≈°ius</label>
                        <select id="surfaceFilter">
                            <option value="">Visi pavir≈°iai</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label for="blizgumasFilter">Blizgumas</label>
                        <select id="blizgumasFilter">
                            <option value="">Visi blizgumai</option>
                        </select>
                    </div>
                </div>
            </div>

            <!-- Stats -->
            <div class="paints-stats">
                <div>
                    <div class="paints-count">
                        Rodoma: <span id="displayedCount">0</span> i≈° <span id="totalCount">0</span> da≈æ≈≥
                    </div>
                    <div id="lastUpdate" style="font-size: 13px; color: #FC9D17; margin-top: 6px; font-weight: 500;">
                        <!-- Last update will be shown here -->
                    </div>
                </div>
                <button class="refresh-btn" onclick="loadPaints()">
                    üîÑ Atnaujinti
                </button>
            </div>

            <!-- Table Container -->
            <div class="paints-table-container">
                <div id="loadingIndicator" class="loading">
                    Kraunama...
                </div>
                <div id="errorMessage" class="error" style="display: none;"></div>
                <table class="paints-table" id="paintsTable" style="display: none;">
                    <thead>
                        <tr>
                            <th onclick="sortTable('gamintojas')">Gamintojas</th>
                            <th onclick="sortTable('kodas')">Kodas</th>
                            <th onclick="sortTable('spalva')">Spalva</th>
                            <th onclick="sortTable('pavirsus')">Pavir≈°ius</th>
                            <th onclick="sortTable('blizgumas')">Blizgumas</th>
                            <th onclick="sortTable('effect')">Efektas</th>
                            <th onclick="sortTable('sudetis')">Sudƒótis</th>
                            <th onclick="sortTable('kiekis')">Kiekis</th>
                            <th onclick="sortTable('ml_kodas')">ML Kodas</th>
                        </tr>
                    </thead>
                    <tbody id="paintsTableBody">
                    </tbody>
                </table>
                <div id="noResults" class="no-results" style="display: none;">
                    Pagal pasirinktus filtrus da≈æ≈≥ nerasta
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-grid">
                <div class="footer-col">
                    <img src="../assets/logo_blur-Aq2Qv48BaWH3VXD1.png" alt="UAB Miltegona" class="footer-logo">
                    <p>Profesionalus miltelinis da≈æymas nuo 2021 met≈≥.</p>
                    <p class="company-code">ƒÆmonƒós kodas: 305813612</p>
                </div>
                <div class="footer-col">
                    <h3>Nuorodos</h3>
                    <ul>
                        <li><a href="/">Prad≈æia</a></li>
                        <li><a href="/apie-mus/">Apie mus</a></li>
                        <li><a href="/miltelinis-dazymas/">Paslaugos</a></li>
                        <li><a href="/dazai/">Turimi da≈æai</a></li>
                        <li><a href="/kaina/">Skaiƒçiuoklƒó</a></li>
                        <li><a href="/kontaktai/">Kontaktai</a></li>
                    </ul>
                </div>
                <div class="footer-col">
                    <h3>Kontaktai</h3>
                    <ul>
                        <li><strong>Pavadinimas:</strong> UAB "Miltegona"</li>
                        <li><strong>Tel:</strong> <a href="tel:+37062502563">+370 625 02563 (Tomas)</a></li>
                        <li><strong>El. pa≈°tas:</strong> <a href="mailto:miltegona@gmail.com">miltegona@gmail.com</a></li>
                        <li><strong>Adresas:</strong> Ateities pl. 30A, LT-52163 Kaunas</li>
                        <li><strong>ƒÆmonƒós kodas:</strong> 305813612</li>
                        <li><strong>PVM kodas:</strong> LT100014222417</li>
                        <li><strong>Darbo laikas:</strong> I-V: 9:00 - 18:00, VI-VII: Nedirbame</li>
                    </ul>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2026 UAB Miltegona. Visos teisƒós saugomos.</p>
            </div>
        </div>
    </footer>

    <!-- Color Popup Modal -->
    <div id="colorPopup" class="color-popup" onclick="closeColorPopup(event)">
        <div class="color-popup-content" onclick="event.stopPropagation()">
            <div id="colorPopupSwatch" class="color-popup-swatch"></div>
            <div id="colorPopupCode" class="color-popup-code"></div>
            <div id="colorPopupHex" class="color-popup-hex"></div>
            <button class="color-popup-close" onclick="closeColorPopup()">U≈ædaryti</button>
        </div>
    </div>

    <script src="../js/main.js"></script>
    <script>
        // Edge Function URL
        const EDGE_FUNCTION_URL = 'https://xyzttzqvbescdpihvyfu.supabase.co/functions/v1/get-paints';
        
        // Complete RAL Classic colors mapping (all 216 colors)
        const RAL_COLORS = {
            'RAL1000':'#BEBD7F','RAL1001':'#C2B078','RAL1002':'#C6A664','RAL1003':'#E5BE01','RAL1004':'#CDA434',
            'RAL1005':'#A98307','RAL1006':'#E4A010','RAL1007':'#DC9D00','RAL1011':'#8A6642','RAL1012':'#C7B446',
            'RAL1013':'#EAE6CA','RAL1014':'#E1CC4F','RAL1015':'#E6D690','RAL1016':'#EDFF21','RAL1017':'#F5D033',
            'RAL1018':'#F8F32B','RAL1019':'#9E9764','RAL1020':'#999950','RAL1021':'#F3DA0B','RAL1023':'#FAD201',
            'RAL1024':'#AEA04B','RAL1026':'#FFFF00','RAL1027':'#9D9101','RAL1028':'#F4A900','RAL1032':'#D6AE01',
            'RAL1033':'#F3A505','RAL1034':'#EFA94A','RAL1035':'#6A5D4D','RAL1036':'#705335','RAL1037':'#F39F18',
            'RAL2000':'#ED760E','RAL2001':'#C93C20','RAL2002':'#CB2821','RAL2003':'#FF7514','RAL2004':'#F44611',
            'RAL2005':'#FF2301','RAL2007':'#FFA420','RAL2008':'#F75E25','RAL2009':'#F54021','RAL2010':'#D84B20',
            'RAL2011':'#EC7C26','RAL2012':'#E55137','RAL2013':'#C35831','RAL3000':'#AF2B1E','RAL3001':'#A52019',
            'RAL3002':'#A2231D','RAL3003':'#9B111E','RAL3004':'#75151E','RAL3005':'#5E2129','RAL3007':'#412227',
            'RAL3009':'#642424','RAL3011':'#781F19','RAL3012':'#C1876B','RAL3013':'#A12312','RAL3014':'#D36E70',
            'RAL3015':'#EA899A','RAL3016':'#B32821','RAL3017':'#E63244','RAL3018':'#D53032','RAL3020':'#CC0605',
            'RAL3022':'#D95030','RAL3024':'#F80000','RAL3026':'#FE0000','RAL3027':'#C51D34','RAL3028':'#CB3234',
            'RAL3031':'#B32428','RAL3032':'#721422','RAL3033':'#B44C43','RAL4001':'#6D3F5B','RAL4002':'#922B3E',
            'RAL4003':'#DE4C8A','RAL4004':'#641C34','RAL4005':'#6C4675','RAL4006':'#A03472','RAL4007':'#4A192C',
            'RAL4008':'#924E7D','RAL4009':'#A18594','RAL4010':'#CF3476','RAL4011':'#8673A1','RAL4012':'#6C6874',
            'RAL5000':'#354D73','RAL5001':'#1F3438','RAL5002':'#20214F','RAL5003':'#1D1E33','RAL5004':'#18171C',
            'RAL5005':'#1E2460','RAL5007':'#3E5F8A','RAL5008':'#26252D','RAL5009':'#025669','RAL5010':'#0E4C8A',
            'RAL5011':'#231A24','RAL5012':'#3B83BD','RAL5013':'#1E213D','RAL5014':'#606E8C','RAL5015':'#2271B3',
            'RAL5017':'#063971','RAL5018':'#3F888F','RAL5019':'#1B5583','RAL5020':'#1D334A','RAL5021':'#256D7B',
            'RAL5022':'#252850','RAL5023':'#49678D','RAL5024':'#5D9B9B','RAL5025':'#2A6478','RAL5026':'#102C54',
            'RAL6000':'#316650','RAL6001':'#287233','RAL6002':'#2D572C','RAL6003':'#424632','RAL6004':'#1F3A3D',
            'RAL6005':'#2F4538','RAL6006':'#3E3B32','RAL6007':'#343B29','RAL6008':'#39352A','RAL6009':'#31372B',
            'RAL6010':'#35682D','RAL6011':'#587246','RAL6012':'#343E40','RAL6013':'#6C7156','RAL6014':'#47402E',
            'RAL6015':'#3B3C36','RAL6016':'#1E5945','RAL6017':'#4C9141','RAL6018':'#57A639','RAL6019':'#BDECB6',
            'RAL6020':'#2E3A23','RAL6021':'#89AC76','RAL6022':'#25221B','RAL6024':'#308446','RAL6025':'#3D642D',
            'RAL6026':'#015D52','RAL6027':'#84C3BE','RAL6028':'#2C5545','RAL6029':'#20603D','RAL6032':'#317F43',
            'RAL6033':'#497E76','RAL6034':'#7FB5B5','RAL6035':'#1C542D','RAL6036':'#193737','RAL6037':'#008F39',
            'RAL6038':'#00BB2D','RAL7000':'#78858B','RAL7001':'#8A9597','RAL7002':'#7E7B52','RAL7003':'#6C7059',
            'RAL7004':'#969992','RAL7005':'#646B63','RAL7006':'#6D6552','RAL7008':'#6A5F31','RAL7009':'#4D5645',
            'RAL7010':'#4C514A','RAL7011':'#434B4D','RAL7012':'#4E5754','RAL7013':'#464531','RAL7015':'#434750',
            'RAL7016':'#293133','RAL7021':'#23282B','RAL7022':'#332F2C','RAL7023':'#686C5E','RAL7024':'#474A51',
            'RAL7026':'#2F353B','RAL7030':'#8B8C7A','RAL7031':'#474B4E','RAL7032':'#B8B799','RAL7033':'#7D8471',
            'RAL7034':'#8F8B66','RAL7035':'#D7D7D7','RAL7036':'#7F7679','RAL7037':'#7D7F7D','RAL7038':'#B5B8B1',
            'RAL7039':'#6C6960','RAL7040':'#9DA1AA','RAL7042':'#8D948D','RAL7043':'#4E5452','RAL7044':'#CAC4B0',
            'RAL7045':'#909090','RAL7046':'#82898F','RAL7047':'#D0D0D0','RAL7048':'#898176','RAL8000':'#826C34',
            'RAL8001':'#955F20','RAL8002':'#6C3B2A','RAL8003':'#734222','RAL8004':'#8E402A','RAL8007':'#59351F',
            'RAL8008':'#6F4F28','RAL8011':'#5B3A29','RAL8012':'#592321','RAL8014':'#382C1E','RAL8015':'#633A34',
            'RAL8016':'#4C2F27','RAL8017':'#45322E','RAL8019':'#403A3A','RAL8022':'#212121','RAL8023':'#A65E2E',
            'RAL8024':'#79553D','RAL8025':'#755C48','RAL8028':'#4E3B31','RAL8029':'#763C28','RAL9001':'#FDF4E3',
            'RAL9002':'#E7EBDA','RAL9003':'#F4F4F4','RAL9004':'#282828','RAL9005':'#0A0A0A','RAL9006':'#A5A5A5',
            'RAL9007':'#8F8F8F','RAL9010':'#FFFFFF','RAL9011':'#1C1C1C','RAL9012':'#FFFFFF','RAL9016':'#F6F6F6',
            'RAL9017':'#1E1E1E','RAL9018':'#D7D7D7','RAL9022':'#9C9C9C','RAL9023':'#828282','RAL6031':'#4F9F4F',
            'RAL3024':'#F80000','RAL1028':'#FFAB00','RAL2013':'#954527','RAL5026':'#0F4C81','RAL6037':'#008F39',
            'RAL6038':'#00BB2D','RAL7048':'#898176','RAL8029':'#763C28','RAL9012':'#FCFCFC'
        };
        
        function extractRALCode(text) {
            if (!text) return null;
            const match = text.match(/RAL\s?\d{4}/i);
            return match ? match[0].replace(/\s/g, '').toUpperCase() : null;
        }
        
        function getRALColor(ralCode) {
            return RAL_COLORS[ralCode] || null;
        }
        
        function showColorPopup(ralCode, hexColor) {
            const popup = document.getElementById('colorPopup');
            const swatch = document.getElementById('colorPopupSwatch');
            const codeEl = document.getElementById('colorPopupCode');
            const hexEl = document.getElementById('colorPopupHex');
            
            swatch.style.backgroundColor = hexColor;
            codeEl.textContent = ralCode;
            hexEl.textContent = hexColor.toUpperCase();
            
            popup.style.display = 'flex';
        }
        
        function closeColorPopup(event) {
            if (!event || event.target.id === 'colorPopup') {
                document.getElementById('colorPopup').style.display = 'none';
            }
        }
        
        // Close popup on Escape key
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                closeColorPopup();
            }
        });
        
        function showColorPopup(ralCode, hexColor) {
            const popup = document.getElementById('colorPopup');
            const swatch = document.getElementById('colorPopupSwatch');
            const codeEl = document.getElementById('colorPopupCode');
            
            swatch.style.backgroundColor = hexColor;
            codeEl.textContent = ralCode;
            
            popup.style.display = 'flex';
        }
        
        function closeColorPopup(event) {
            if (!event || event.target.id === 'colorPopup') {
                document.getElementById('colorPopup').style.display = 'none';
            }
        }
        
        // Close popup on Escape key
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                closeColorPopup();
            }
        });
        
        let allPaints = [];
        let filteredPaints = [];
        let sortColumn = 'gamintojas';
        let sortDirection = 'asc';
        
        // Load paints from Edge Function (read-only, secure)
        async function loadPaints() {
            const loadingIndicator = document.getElementById('loadingIndicator');
            const errorMessage = document.getElementById('errorMessage');
            const paintsTable = document.getElementById('paintsTable');
            
            loadingIndicator.style.display = 'block';
            errorMessage.style.display = 'none';
            paintsTable.style.display = 'none';
            
            try {
                const response = await fetch(EDGE_FUNCTION_URL);
                
                if (!response.ok) {
                    throw new Error('Nepavyko u≈ækrauti da≈æ≈≥ duomen≈≥');
                }
                
                const result = await response.json();
                
                if (result.error) {
                    throw new Error(result.error);
                }
                
                allPaints = result.paints || [];
                
                // Update last change display with timestamp from database
                if (result.lastChange) {
                    updateLastUpdateDisplay(result.lastChange);
                }
                
                populateFilters();
                applyFilters();
                
                loadingIndicator.style.display = 'none';
                paintsTable.style.display = 'table';
            } catch (error) {
                console.error('Error loading paints:', error);
                loadingIndicator.style.display = 'none';
                errorMessage.textContent = 'Klaida kraunant da≈æ≈≥ duomenis. Pabandykite vƒóliau.';
                errorMessage.style.display = 'block';
            }
        }
        
        // Display last database change timestamp
        function updateLastUpdateDisplay(lastChangeISO) {
            const displayElement = document.getElementById('lastUpdate');
            
            if (lastChangeISO && displayElement) {
                const date = new Date(lastChangeISO);
                const now = new Date();
                const diffMs = now - date;
                const diffMins = Math.floor(diffMs / 60000);
                const diffHours = Math.floor(diffMs / 3600000);
                const diffDays = Math.floor(diffMs / 86400000);
                
                let timeAgo = '';
                if (diffMins < 1) {
                    timeAgo = 'kƒÖ tik';
                } else if (diffMins < 60) {
                    timeAgo = `prie≈° ${diffMins} min.`;
                } else if (diffHours < 24) {
                    timeAgo = `prie≈° ${diffHours} val.`;
                } else if (diffDays === 1) {
                    timeAgo = 'vakar';
                } else if (diffDays < 7) {
                    timeAgo = `prie≈° ${diffDays} d.`;
                } else {
                    timeAgo = date.toLocaleDateString('lt-LT', { 
                        year: 'numeric', 
                        month: 'long', 
                        day: 'numeric',
                        hour: '2-digit',
                        minute: '2-digit'
                    });
                }
                
                displayElement.textContent = `Paskutinis pakeitimas duomen≈≥ bazƒóje: ${timeAgo}`;
            }
        }
        
        // Populate filter dropdowns
        function populateFilters() {
            // Helper function to translate blizgumas
            function translateBlizgumas(blizgumas) {
                const blizgumasLower = blizgumas.toLowerCase();
                if (blizgumasLower.startsWith('semigloss') || blizgumasLower.startsWith('semimatt')) {
                    return 'Pusiau blizg≈´s';
                } else if (blizgumasLower.includes('high gloss')) {
                    return 'Labai blizg≈´s';
                } else if (blizgumasLower.startsWith('ultramatt')) {
                    return 'Ultra matiniai';
                } else if (blizgumasLower.startsWith('matt')) {
                    return 'Matiniai';
                } else if (blizgumasLower.startsWith('glossy')) {
                    return 'Blizg≈´s';
                }
                return blizgumas;
            }
            
            const manufacturers = [...new Set(allPaints.map(p => p.gamintojas).filter(Boolean))].sort();
            const surfaces = [...new Set(allPaints.map(p => p.pavirsus).filter(Boolean))].sort();
            const blizgumai = [...new Set(allPaints.map(p => p.blizgumas).filter(Boolean))].sort();
            
            const manufacturerFilter = document.getElementById('manufacturerFilter');
            manufacturerFilter.innerHTML = '<option value="">Visi gamintojai</option>' +
                manufacturers.map(m => `<option value="${m}">${m}</option>`).join('');
            
            const surfaceFilter = document.getElementById('surfaceFilter');
            surfaceFilter.innerHTML = '<option value="">Visi pavir≈°iai</option>' +
                surfaces.map(s => {
                    const translated = s.replace('Smooth', 'Lygus')
                                        .replace('Rough', '≈†iurk≈°tus')
                                        .replace('Textured', 'Tekst≈´ruotas');
                    return `<option value="${s}">${translated}</option>`;
                }).join('');
            
            // Group blizgumai by translated name
            const blizgumasGroups = {};
            blizgumai.forEach(b => {
                const translated = translateBlizgumas(b);
                if (!blizgumasGroups[translated]) {
                    blizgumasGroups[translated] = [];
                }
                blizgumasGroups[translated].push(b);
            });
            
            // Custom sort order for blizgumas
            const blizgumasOrder = ['Labai blizg≈´s', 'Blizg≈´s', 'Pusiau blizg≈´s', 'Matiniai', 'Ultra matiniai'];
            const sortedBlizgumas = Object.keys(blizgumasGroups).sort((a, b) => {
                const indexA = blizgumasOrder.indexOf(a);
                const indexB = blizgumasOrder.indexOf(b);
                if (indexA === -1 && indexB === -1) return a.localeCompare(b);
                if (indexA === -1) return 1;
                if (indexB === -1) return -1;
                return indexA - indexB;
            });
            
            const blizgumasFilter = document.getElementById('blizgumasFilter');
            blizgumasFilter.innerHTML = '<option value="">Visi blizgumai</option>' +
                sortedBlizgumas.map(translatedName => {
                    const originalValues = blizgumasGroups[translatedName].join(',');
                    return `<option value="${originalValues}">${translatedName}</option>`;
                }).join('');
        }
        
        // Apply filters
        function applyFilters() {
            const searchText = document.getElementById('searchInput').value.toLowerCase();
            const manufacturer = document.getElementById('manufacturerFilter').value;
            const surface = document.getElementById('surfaceFilter').value;
            const blizgumas = document.getElementById('blizgumasFilter').value;
            
            // Split blizgumas filter value (it may contain comma-separated values)
            const blizgumasValues = blizgumas ? blizgumas.split(',') : [];
            
            filteredPaints = allPaints.filter(paint => {
                const matchesSearch = !searchText || 
                    (paint.gamintojas && paint.gamintojas.toLowerCase().includes(searchText)) ||
                    (paint.spalva && paint.spalva.toLowerCase().includes(searchText)) ||
                    (paint.kodas && paint.kodas.toLowerCase().includes(searchText)) ||
                    (paint.ml_kodas && paint.ml_kodas.toLowerCase().includes(searchText));
                
                const matchesManufacturer = !manufacturer || paint.gamintojas === manufacturer;
                
                const matchesSurface = !surface || paint.pavirsus === surface;
                
                const matchesBlizgumas = !blizgumas || blizgumasValues.includes(paint.blizgumas);
                
                return matchesSearch && matchesManufacturer && matchesSurface && matchesBlizgumas;
            });
            
            sortPaints();
            renderTable();
            updateStats();
        }
        
        // Sort paints
        function sortPaints() {
            filteredPaints.sort((a, b) => {
                let aVal = a[sortColumn] || '';
                let bVal = b[sortColumn] || '';
                
                // For quantity, parse as number
                if (sortColumn === 'kiekis') {
                    aVal = parseFloat(aVal) || 0;
                    bVal = parseFloat(bVal) || 0;
                }
                
                // For ML code, extract number and sort numerically
                if (sortColumn === 'ml_kodas') {
                    const aNum = parseInt((aVal.match(/\d+/) || [0])[0]) || 0;
                    const bNum = parseInt((bVal.match(/\d+/) || [0])[0]) || 0;
                    aVal = aNum;
                    bVal = bNum;
                }
                
                if (aVal < bVal) return sortDirection === 'asc' ? -1 : 1;
                if (aVal > bVal) return sortDirection === 'asc' ? 1 : -1;
                return 0;
            });
        }
        
        // Sort table
        function sortTable(column) {
            if (sortColumn === column) {
                sortDirection = sortDirection === 'asc' ? 'desc' : 'asc';
            } else {
                sortColumn = column;
                sortDirection = 'asc';
            }
            sortPaints();
            renderTable();
        }
        
        // Render table
        function renderTable() {
            const tbody = document.getElementById('paintsTableBody');
            const noResults = document.getElementById('noResults');
            const paintsTable = document.getElementById('paintsTable');
            
            if (filteredPaints.length === 0) {
                paintsTable.style.display = 'none';
                noResults.style.display = 'block';
                return;
            }
            
            paintsTable.style.display = 'table';
            noResults.style.display = 'none';
            
            tbody.innerHTML = filteredPaints.map(paint => {
                let pavirsus = paint.pavirsus || '-';
                pavirsus = pavirsus.replace('Smooth', 'Lygus')
                                   .replace('Rough', '≈†iurk≈°tus')
                                   .replace('Textured', 'Tekst≈´ruotas');
                
                let blizgumas = paint.blizgumas || '-';
                if (blizgumas !== '-') {
                    const blizgumasLower = blizgumas.toLowerCase();
                    if (blizgumasLower.startsWith('semigloss') || blizgumasLower.startsWith('semimatt')) {
                        blizgumas = 'Pusiau blizg≈´s';
                    } else if (blizgumasLower.includes('high gloss')) {
                        blizgumas = 'Labai blizg≈´s';
                    } else if (blizgumasLower.startsWith('ultramatt')) {
                        blizgumas = 'Ultra matiniai';
                    } else if (blizgumasLower.startsWith('matt')) {
                        blizgumas = 'Matiniai';
                    } else if (blizgumasLower.startsWith('glossy')) {
                        blizgumas = 'Blizg≈´s';
                    }
                }
                
                // Extract RAL code and get color
                const ralCode = extractRALCode(paint.kodas) || extractRALCode(paint.spalva);
                const ralColor = ralCode ? getRALColor(ralCode) : null;
                const colorPreview = ralColor ? 
                    `<span class="color-preview" style="background-color: ${ralColor};" 
                           data-ral="${ralCode}" data-hex="${ralColor}" 
                           onclick="showColorPopup('${ralCode}', '${ralColor}')"></span>` : '';
                
                // Translate effect
                let effect = paint.effect || '-';
                if (effect !== '-') {
                    const effectLower = effect.toLowerCase();
                    if (effectLower === 'clear') {
                        effect = 'Lakas';
                    } else if (effectLower === 'normal' || effectLower === 'cinkui') {
                        effect = '-';
                    }
                }
                
                return `
                <tr>
                    <td>${paint.gamintojas || '-'}</td>
                    <td>${paint.kodas || '-'}</td>
                    <td><span class="color-badge">${colorPreview}${paint.spalva || '-'}</span></td>
                    <td>${pavirsus}</td>
                    <td>${blizgumas}</td>
                    <td>${effect}</td>
                    <td>${paint.sudetis || '-'}</td>
                    <td class="quantity">${paint.kiekis || '0'}</td>
                    <td>${paint.ml_kodas || '-'}</td>
                </tr>
                `;
            }).join('');
        }
        
        // Update stats
        function updateStats() {
            document.getElementById('displayedCount').textContent = filteredPaints.length;
            document.getElementById('totalCount').textContent = allPaints.length;
        }
        
        // Event listeners
        document.getElementById('searchInput').addEventListener('input', applyFilters);
        document.getElementById('manufacturerFilter').addEventListener('change', applyFilters);
        document.getElementById('surfaceFilter').addEventListener('change', applyFilters);
        document.getElementById('blizgumasFilter').addEventListener('change', applyFilters);
        
        // Initial load
        // Load paints on page load
        loadPaints();
    </script>
</body>
</html>
